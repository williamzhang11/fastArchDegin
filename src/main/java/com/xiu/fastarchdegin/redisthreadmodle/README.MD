# redis线程模型

采用多路 I/O 

 复用技术可以让单个线程高效的处理多个连接请求（尽量减少网络IO的时间消耗）

redis内部使用文件事件处理器 file event handler 这个文件事件处理器是单线程的,所有叫
单线程模型.采用IO多路复用机制同时监听多个socket,根据socket上的事件选择对应的事件处理器处理.

![image](https://github.com/williamzhang11/fastArchDegin/blob/master/src/main/java/com/xiu/fastarchdegin/kafka/image/redisthread.png)


多个socket可能会并发产生不同的操作,每个操作对应不同文件事件,但IO多路复用程序会监听多个socket,
会将socket产生的事件放入队列中排队,事件分派器每次从队列中取出一个事件,把事件交给对应的事件处理器处理

redis客户端对服务端调用都经历发送命令,执行命令,返回结果3个过程.其中执行命令阶段,由于redis
是单线程处理命令,所有每一条到达服务端的命令不会立即执行,所有命令都会进入一个队列中,逐个执行.


# 为什么 Redis 单线程模型也能效率这么高?

## 1、纯内存操作

Redis 为了达到最快的读写速度，将数据都读到内存中，并通过异步的方式将数据写入磁盘。
所以 Redis 具有快速和数据持久化的特征。
如果不将数据放在内存中，磁盘 I/O 速度为严重影响 Redis 的性能。

## 2.核心是基于非阻塞的 IO 多路复用机制

 “多路”指的是多个网络连接，“复用”指的是复用同一个线程。采用多路 I/O 
 复用技术可以让单个线程高效的处理多个连接请求（尽量减少网络IO的时间消耗）。
 可以直接理解为：单线程的原子操作，避免上下文切换的时间和性能消耗；加上对内存中数据的处理速度，
 很自然的提高redis的吞吐量。

## 3.单线程反而避免了多线程的频繁上下文切换问题

Redis 利用队列技术，将并发访问变为串行访问，消除了传统数据库串行控制的开销

## 4.Redis 还有一些特殊的数据结构，对数据存储进行了优化，如压缩表，对短数据进行压缩存储，
再如，跳表，使用有序的数据结构加快读取的速度。













